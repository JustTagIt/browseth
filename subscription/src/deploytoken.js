const Browseth = require('browseth').default;
const {XMLHttpRequest} = require('xmlhttprequest');

global.XMLHttpRequest = XMLHttpRequest;

const subabi = [
  {
    constant: true,
    inputs: [],
    name: 'name',
    outputs: [{name: '', type: 'string'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_tokenId', type: 'uint256'}],
    name: 'getApproved',
    outputs: [{name: '', type: 'address'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [
      {name: '_to', type: 'address'},
      {name: '_tokenId', type: 'uint256'},
    ],
    name: 'approve',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_index', type: 'uint256'}],
    name: 'getTokenId',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_tokenId', type: 'uint256'}],
    name: 'expiresAt',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'totalSupply',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [
      {name: '_from', type: 'address'},
      {name: '_to', type: 'address'},
      {name: '_tokenId', type: 'uint256'},
    ],
    name: 'transferFrom',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [
      {name: '_owner', type: 'address'},
      {name: '_index', type: 'uint256'},
    ],
    name: 'tokenOfOwnerByIndex',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_subscriptionLength', type: 'uint256'}],
    name: 'getAmountFromTime',
    outputs: [{name: '_amount', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [],
    name: 'unpause',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: false,
    inputs: [
      {name: '_from', type: 'address'},
      {name: '_to', type: 'address'},
      {name: '_tokenId', type: 'uint256'},
    ],
    name: 'safeTransferFrom',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_tokenId', type: 'uint256'}],
    name: 'exists',
    outputs: [{name: '', type: 'bool'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_index', type: 'uint256'}],
    name: 'tokenByIndex',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [{name: '_priceCurve', type: 'address'}],
    name: 'setPriceCurve',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: false,
    inputs: [{name: '_tokenId', type: 'uint256'}],
    name: 'renew',
    outputs: [],
    payable: true,
    stateMutability: 'payable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'paused',
    outputs: [{name: '', type: 'bool'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_tokenId', type: 'uint256'}],
    name: 'ownerOf',
    outputs: [{name: '', type: 'address'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_owner', type: 'address'}],
    name: 'balanceOf',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [],
    name: 'renounceOwnership',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: false,
    inputs: [],
    name: 'pause',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'owner',
    outputs: [{name: '', type: 'address'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'symbol',
    outputs: [{name: '', type: 'string'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'getPriceCurve',
    outputs: [{name: '', type: 'address'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [{name: '_to', type: 'address'}, {name: '_approved', type: 'bool'}],
    name: 'setApprovalForAll',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'getMinimumPrice',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [
      {name: '_from', type: 'address'},
      {name: '_to', type: 'address'},
      {name: '_tokenId', type: 'uint256'},
      {name: '_data', type: 'bytes'},
    ],
    name: 'safeTransferFrom',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_tokenId', type: 'uint256'}],
    name: 'tokenURI',
    outputs: [{name: '', type: 'string'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [
      {name: '_owner', type: 'address'},
      {name: '_operator', type: 'address'},
    ],
    name: 'isApprovedForAll',
    outputs: [{name: '', type: 'bool'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [{name: '_newOwner', type: 'address'}],
    name: 'transferOwnership',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    inputs: [{name: '_priceCurve', type: 'address'}],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'constructor',
  },
  {payable: true, stateMutability: 'payable', type: 'fallback'},
  {anonymous: false, inputs: [], name: 'Pause', type: 'event'},
  {anonymous: false, inputs: [], name: 'Unpause', type: 'event'},
  {
    anonymous: false,
    inputs: [{indexed: true, name: 'previousOwner', type: 'address'}],
    name: 'OwnershipRenounced',
    type: 'event',
  },
  {
    anonymous: false,
    inputs: [
      {indexed: true, name: 'previousOwner', type: 'address'},
      {indexed: true, name: 'newOwner', type: 'address'},
    ],
    name: 'OwnershipTransferred',
    type: 'event',
  },
  {
    anonymous: false,
    inputs: [
      {indexed: true, name: '_from', type: 'address'},
      {indexed: true, name: '_to', type: 'address'},
      {indexed: false, name: '_tokenId', type: 'uint256'},
    ],
    name: 'Transfer',
    type: 'event',
  },
  {
    anonymous: false,
    inputs: [
      {indexed: true, name: '_owner', type: 'address'},
      {indexed: true, name: '_approved', type: 'address'},
      {indexed: false, name: '_tokenId', type: 'uint256'},
    ],
    name: 'Approval',
    type: 'event',
  },
  {
    anonymous: false,
    inputs: [
      {indexed: true, name: '_owner', type: 'address'},
      {indexed: true, name: '_operator', type: 'address'},
      {indexed: false, name: '_approved', type: 'bool'},
    ],
    name: 'ApprovalForAll',
    type: 'event',
  },
];

const subbin =
  '6080604052600b805460a060020a60ff02191690553480156200002157600080fd5b506040516020806200188383398101604081815291518282018352601182527f537562736372697074696f6e546f6b656e00000000000000000000000000000060208084019182528451808601909552600385527f5355420000000000000000000000000000000000000000000000000000000000908501528251919391620000ad91600491620000fb565b508051620000c3906005906020840190620000fb565b5050600b805433600160a060020a031991821617909155600c8054909116600160a060020a03939093169290921790915550620001a0565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200013e57805160ff19168380011785556200016e565b828001600101855582156200016e579182015b828111156200016e57825182559160200191906001019062000151565b506200017c92915062000180565b5090565b6200019d91905b808211156200017c576000815560010162000187565b90565b6116d380620001b06000396000f3006080604052600436106101745763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166306fdde038114610237578063081812fc146102c1578063095ea7b3146102f557806314ff5ea31461031b57806317c957091461034557806318160ddd1461035d57806323b872dd146103725780632f745c591461039c5780633878bb2d146103c05780633f4ba83a146103d857806342842e0e146103ed5780634f558e79146104175780634f6ccce7146104435780635718ec291461045b5780635baa75091461047c5780635c975abb146104875780636352211e1461049c57806370a08231146104b4578063715018a6146104d55780638456cb59146104ea5780638da5cb5b146104ff57806395d89b41146105145780639609f6c714610529578063a22cb4651461053e578063ac4316cb14610564578063b88d4fde14610579578063c87b56dd146105e8578063e985e9c514610600578063f2fde38b14610627575b600b5460a060020a900460ff161561018b57600080fd5b600c54604080517f24b545e00000000000000000000000000000000000000000000000000000000081523460048201529051610234923392600160a060020a03909116916324b545e0916024808201926020929091908290030181600087803b1580156101f757600080fd5b505af115801561020b573d6000803e3d6000fd5b505050506040513d602081101561022157600080fd5b505167ffffffffffffffff164201610648565b50005b34801561024357600080fd5b5061024c61068e565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561028657818101518382015260200161026e565b50505050905090810190601f1680156102b35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156102cd57600080fd5b506102d9600435610725565b60408051600160a060020a039092168252519081900360200190f35b34801561030157600080fd5b50610319600160a060020a0360043516602435610740565b005b34801561032757600080fd5b50610333600435610825565b60408051918252519081900360200190f35b34801561035157600080fd5b50610333600435610868565b34801561036957600080fd5b50610333610879565b34801561037e57600080fd5b50610319600160a060020a036004358116906024351660443561087f565b3480156103a857600080fd5b50610333600160a060020a036004351660243561092e565b3480156103cc57600080fd5b5061033360043561097b565b3480156103e457600080fd5b50610319610a13565b3480156103f957600080fd5b50610319600160a060020a0360043581169060243516604435610a8b565b34801561042357600080fd5b5061042f600435610ac3565b604080519115158252519081900360200190f35b34801561044f57600080fd5b50610333600435610ae0565b34801561046757600080fd5b50610319600160a060020a0360043516610b03565b610319600435610b25565b34801561049357600080fd5b5061042f610be7565b3480156104a857600080fd5b506102d9600435610bf7565b3480156104c057600080fd5b50610333600160a060020a0360043516610c21565b3480156104e157600080fd5b50610319610c54565b3480156104f657600080fd5b50610319610cb5565b34801561050b57600080fd5b506102d9610d32565b34801561052057600080fd5b5061024c610d41565b34801561053557600080fd5b506102d9610da2565b34801561054a57600080fd5b50610319600160a060020a03600435166024351515610db1565b34801561057057600080fd5b50610333610e35565b34801561058557600080fd5b50604080516020601f60643560048181013592830184900484028501840190955281845261031994600160a060020a038135811695602480359092169560443595369560849401918190840183828082843750949750610ec59650505050505050565b3480156105f457600080fd5b5061024c600435610f04565b34801561060c57600080fd5b5061042f600160a060020a0360043581169060243516610fb9565b34801561063357600080fd5b50610319600160a060020a0360043516610fe7565b600d805460018101825560009182527fd7b6990105719101dabeb77144f2a3385c8033acd3af97e9423a695e81ad1eb58101839055610687848261100a565b9392505050565b60048054604080516020601f600260001961010060018816150201909516949094049384018190048102820181019092528281526060939092909183018282801561071a5780601f106106ef5761010080835404028352916020019161071a565b820191906000526020600020905b8154815290600101906020018083116106fd57829003601f168201915b505050505090505b90565b600090815260016020526040902054600160a060020a031690565b600061074b82610bf7565b9050600160a060020a03838116908216141561076657600080fd5b33600160a060020a038216148061078257506107828133610fb9565b151561078d57600080fd5b600061079883610725565b600160a060020a03161415806107b65750600160a060020a03831615155b15610820576000828152600160209081526040918290208054600160a060020a031916600160a060020a03878116918217909255835186815293519093918516927f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925928290030190a35b505050565b600061083033610c21565b821061083b57600080fd5b33600090815260066020526040902080548390811061085657fe5b90600052602060002001549050919050565b6000600d8281548110151561085657fe5b60085490565b8061088a3382611059565b151561089557600080fd5b600160a060020a03841615156108aa57600080fd5b600160a060020a03831615156108bf57600080fd5b6108c984836110b8565b6108d38483611159565b6108dd8383611292565b82600160a060020a031684600160a060020a03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040518082815260200191505060405180910390a350505050565b600061093983610c21565b821061094457600080fd5b600160a060020a038316600090815260066020526040902080548390811061096857fe5b9060005260206000200154905092915050565b600c54604080517f3878bb2d000000000000000000000000000000000000000000000000000000008152600481018490529051600092600160a060020a031691633878bb2d91602480830192602092919082900301818787803b1580156109e157600080fd5b505af11580156109f5573d6000803e3d6000fd5b505050506040513d6020811015610a0b57600080fd5b505192915050565b600b54600160a060020a03163314610a2a57600080fd5b600b5460a060020a900460ff161515610a4257600080fd5b600b805474ff0000000000000000000000000000000000000000191690556040517f7805862f689e2f13df9f062ff482ad3ad112aca9e0847911ed832e158c525b3390600090a1565b80610a963382611059565b1515610aa157600080fd5b610abd8484846020604051908101604052806000815250610ec5565b50505050565b600090815260208190526040902054600160a060020a0316151590565b6000610aea610879565b8210610af557600080fd5b600880548390811061085657fe5b600c8054600160a060020a031916600160a060020a0392909216919091179055565b600c54604080517f24b545e00000000000000000000000000000000000000000000000000000000081523460048201529051600160a060020a03909216916324b545e0916024808201926020929091908290030181600087803b158015610b8b57600080fd5b505af1158015610b9f573d6000803e3d6000fd5b505050506040513d6020811015610bb557600080fd5b5051600d805467ffffffffffffffff9092169183908110610bd257fe5b60009182526020909120018054909101905550565b600b5460a060020a900460ff1681565b600081815260208190526040812054600160a060020a0316801515610c1b57600080fd5b92915050565b6000600160a060020a0382161515610c3857600080fd5b50600160a060020a031660009081526002602052604090205490565b600b54600160a060020a03163314610c6b57600080fd5b600b54604051600160a060020a03909116907ff8df31144d9c2f0f6b59d69b8b98abd5459d07f2742c4df920b25aae33c6482090600090a2600b8054600160a060020a0319169055565b600b54600160a060020a03163314610ccc57600080fd5b600b5460a060020a900460ff1615610ce357600080fd5b600b805474ff0000000000000000000000000000000000000000191660a060020a1790556040517f6985a02210a168e66602d3235cb6db0e70f92b3ba4d376a33c0f3d9434bff62590600090a1565b600b54600160a060020a031681565b60058054604080516020601f600260001961010060018816150201909516949094049384018190048102820181019092528281526060939092909183018282801561071a5780601f106106ef5761010080835404028352916020019161071a565b600c54600160a060020a031690565b600160a060020a038216331415610dc757600080fd5b336000818152600360209081526040808320600160a060020a03871680855290835292819020805460ff1916861515908117909155815190815290519293927f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31929181900390910190a35050565b600c54604080517fac4316cb0000000000000000000000000000000000000000000000000000000081529051600092600160a060020a03169163ac4316cb91600480830192602092919082900301818787803b158015610e9457600080fd5b505af1158015610ea8573d6000803e3d6000fd5b505050506040513d6020811015610ebe57600080fd5b5051905090565b81610ed03382611059565b1515610edb57600080fd5b610ee685858561087f565b610ef2858585856112db565b1515610efd57600080fd5b5050505050565b6060610f0f82610ac3565b1515610f1a57600080fd5b6000828152600a602090815260409182902080548351601f600260001961010060018616150201909316929092049182018490048402810184019094528084529091830182828015610fad5780601f10610f8257610100808354040283529160200191610fad565b820191906000526020600020905b815481529060010190602001808311610f9057829003601f168201915b50505050509050919050565b600160a060020a03918216600090815260036020908152604080832093909416825291909152205460ff1690565b600b54600160a060020a03163314610ffe57600080fd5b61100781611464565b50565b61101482826114d5565b600880546000838152600960205260408120829055600182018355919091527ff3f7a9fe364faab93b216da50a3214154f22a0a2b415b23a84c8169e8b636ee3015550565b60008061106583610bf7565b905080600160a060020a031684600160a060020a031614806110a0575083600160a060020a031661109584610725565b600160a060020a0316145b806110b057506110b08185610fb9565b949350505050565b81600160a060020a03166110cb82610bf7565b600160a060020a0316146110de57600080fd5b600081815260016020526040902054600160a060020a0316156111555760008181526001602090815260408083208054600160a060020a031916905580518481529051600160a060020a038616927f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925928290030190a35b5050565b60008060006111688585611539565b600084815260076020908152604080832054600160a060020a03891684526006909252909120549093506111a390600163ffffffff6115c116565b600160a060020a0386166000908152600660205260409020805491935090839081106111cb57fe5b90600052602060002001549050806006600087600160a060020a0316600160a060020a031681526020019081526020016000208481548110151561120b57fe5b6000918252602080832090910192909255600160a060020a038716815260069091526040812080548490811061123d57fe5b6000918252602080832090910192909255600160a060020a038716815260069091526040902080549061127490600019830161166a565b50600093845260076020526040808520859055908452909220555050565b600061129e83836115d3565b50600160a060020a039091166000908152600660209081526040808320805460018101825590845282842081018590559383526007909152902055565b6000806112f085600160a060020a0316611655565b15156112ff576001915061145b565b84600160a060020a031663f0b9e5ba8786866040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018084600160a060020a0316600160a060020a0316815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b8381101561139757818101518382015260200161137f565b50505050905090810190601f1680156113c45780820380516001836020036101000a031916815260200191505b50945050505050602060405180830381600087803b1580156113e557600080fd5b505af11580156113f9573d6000803e3d6000fd5b505050506040513d602081101561140f57600080fd5b50517fffffffff0000000000000000000000000000000000000000000000000000000081167ff0b9e5ba0000000000000000000000000000000000000000000000000000000014925090505b50949350505050565b600160a060020a038116151561147957600080fd5b600b54604051600160a060020a038084169216907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a3600b8054600160a060020a031916600160a060020a0392909216919091179055565b600160a060020a03821615156114ea57600080fd5b6114f48282611292565b604080518281529051600160a060020a038416916000917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9181900360200190a35050565b81600160a060020a031661154c82610bf7565b600160a060020a03161461155f57600080fd5b600160a060020a03821660009081526002602052604090205461158990600163ffffffff6115c116565b600160a060020a0390921660009081526002602090815260408083209490945591815290819052208054600160a060020a0319169055565b6000828211156115cd57fe5b50900390565b600081815260208190526040902054600160a060020a0316156115f557600080fd5b6000818152602081815260408083208054600160a060020a031916600160a060020a0387169081179091558352600290915290205461163590600161165d565b600160a060020a0390921660009081526002602052604090209190915550565b6000903b1190565b81810182811015610c1b57fe5b8154818355818111156108205760008381526020902061082091810190830161072291905b808211156116a3576000815560010161168f565b50905600a165627a7a7230582027c788a46ee7fbd23f44cba95d9bf848ee2b149b001f3112fbe3dbaac5acf0ee0029';

const curvebin =
  '608060405234801561001057600080fd5b5060405160408061027d83398101604052805160209091015160009190915560015561023c806100416000396000f3006080604052600436106100825763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166324b545e08114610087578063256645ca146100bc57806333761bf5146100e35780633878bb2d146100fd578063564aa87b146101155780635ccab7391461012a578063ac4316cb14610142575b600080fd5b34801561009357600080fd5b5061009f600435610157565b6040805167ffffffffffffffff9092168252519081900360200190f35b3480156100c857600080fd5b506100d1610182565b60408051918252519081900360200190f35b3480156100ef57600080fd5b506100fb600435610188565b005b34801561010957600080fd5b506100d16004356101b8565b34801561012157600080fd5b506100d16101d0565b34801561013657600080fd5b506100fb6004356101d6565b34801561014e57600080fd5b506100d1610206565b600060015460005402821015151561016e57600080fd5b6001548281151561017b57fe5b0492915050565b60005490565b600081815560405182917fd6f065b257f06a6bdb1a65de715fc4bd7d1936a621fe6db83ee006f7bdd1ab7b91a250565b600080548210156101c857600080fd5b506001540290565b60015490565b600081815560405182917f83ea970c358cb64b0df74ba055d6e9737792c7a110c2649d67055a1c4d5eb24491a250565b60015460005402905600a165627a7a72305820caa81cdf6ccbfbfb0d403a6f1ef9154da271e55833f383e91c8a8c0b7a4801430029';

const curveabi = [
  {
    constant: true,
    inputs: [{name: '_amount', type: 'uint256'}],
    name: 'getTimeFromAmount',
    outputs: [{name: '_subscriptionLength', type: 'uint64'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'getMinimumTime',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [{name: '_costPerSecond', type: 'uint256'}],
    name: 'setCostPerSecond',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [{name: '_subscriptionLength', type: 'uint256'}],
    name: 'getAmountFromTime',
    outputs: [{name: '_amount', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'getCostPerSecond',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    constant: false,
    inputs: [{name: '_minimumTime', type: 'uint256'}],
    name: 'setMinimumTime',
    outputs: [],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'function',
  },
  {
    constant: true,
    inputs: [],
    name: 'getMinimumPrice',
    outputs: [{name: '', type: 'uint256'}],
    payable: false,
    stateMutability: 'view',
    type: 'function',
  },
  {
    inputs: [
      {name: '_minimumTime', type: 'uint256'},
      {name: '_costPerSecond', type: 'uint256'},
    ],
    payable: false,
    stateMutability: 'nonpayable',
    type: 'constructor',
  },
  {
    anonymous: false,
    inputs: [{indexed: true, name: 'minimumTime', type: 'uint256'}],
    name: 'SetMinimumTime',
    type: 'event',
  },
  {
    anonymous: false,
    inputs: [{indexed: true, name: 'costPerSecond', type: 'uint256'}],
    name: 'SetCostPerSecond',
    type: 'event',
  },
];

const b = new Browseth();

b.wallet = new Browseth.Wallets.Online(b.rpc);

// it('', async () => {
const a = async () => {
  // console.log(abi);
  const transactionListener = new Browseth.Apis.TransactionListener(b.wallet);
  transactionListener.startPolling();

  b.addContract('priceCurve', curveabi, {bytecode: curvebin});
  b.addContract('subscription', subabi, {bytecode: subbin});

  const transactionHash1 = await b.contract.priceCurve
    .deploy(31540000, 380469245)
    .send();
  console.log('transaction hash for paid price curve', transactionHash1);
  const transaction1 = await transactionListener.resolveTransaction(
    transactionHash1,
  );
  console.log('transaction for paid price curve', transaction1);

  const transactionHash2 = await b.contract.priceCurve
    .deploy(3154000000, 0)
    .send();
  console.log('transaction hash for free price curve', transactionHash2);
  const transaction2 = await transactionListener.resolveTransaction(
    transactionHash2,
  );
  console.log('transaction for free price curve', transaction1);

  const transactionHash3 = await b.contract.subscription
    .deploy(transaction1.contractAddress)
    .send();
  console.log('transaction hash for token', transactionHash3);
  const transaction3 = await transactionListener.resolveTransaction(
    transactionHash3,
  );

  const transactionHash4 = await b.contract.subscription
    .deploy(transaction2.contractAddress)
    .send();
  console.log('transaction hash for token', transactionHash4);
  const transaction4 = await transactionListener.resolveTransaction(
    transactionHash4,
  );

  console.log('address for paid token', transaction3.contractAddress);
  console.log('address for free token', transaction4.contractAddress);
};

a();
